---
import Layout from '../../layouts/Layout.astro';
import { products } from '../../data/products'; // Импортираме продуктите
const base = import.meta.env.BASE_URL;
export async function getStaticPaths() {
  // Дефинираме категориите
  const categories = [
    // 1. Вертикални
    { 
        slug: 'vertical', 
        title: 'Вертикални щори', 
        desc: 'Практично и стилно решение за големи прозорци и офиси. Огромен избор от текстилни и PVC ленти.', 
        hero: '/images/vertical/hero-vertical.png' 
    },
    // 2. Венециански
    { 
        slug: 'venetian', 
        title: 'Венециански щори', 
        desc: 'Класически алуминиеви хоризонтални щори. Прецизен контрол на светлината и лесна поддръжка.', 
        hero: '/images/hero-venetian.jpg' 
    },
    // 3. Плисе
    { 
        slug: 'plise', 
        title: 'Плисе щори', 
        desc: 'Модерен дизайн с възможност за движение в двете посоки ("Ден и Нощ"). Идеални за нестандартни форми.', 
        hero: '/images/hero-plise.jpg' 
    },
    // 4. Дървени
    { 
        slug: 'wooden', 
        title: 'Дървени щори', 
        desc: 'Лукс и топлина от естествен материал. Предлагаме Басвуд и Бамбук в различни ширини (25мм, 50мм).', 
        hero: '/images/hero-wooden.jpg' 
    },
    // 5. Римски (вкл. Делукс, Мини, Макс)
    { 
        slug: 'roman', 
        title: 'Римски щори', 
        desc: 'Текстилен уют за дома. Включва модели: Делукс, Мини, Макс и Макс Бокс.', 
        hero: '/images/hero-roman.jpg' 
    },
    // 6. Руло (вкл. Кутия, Водачи)
    { 
        slug: 'roller', 
        title: 'Руло щори', 
        desc: 'Изчистен дизайн за всеки интериор. Варианти: Стандарт, С кутия и водачи, Руло Макс.', 
        hero: '/images/hero-roller.jpg' 
    },
    // 7. Ден и Нощ (Зебра)
    { 
        slug: 'day-night', 
        title: 'Щори Ден и Нощ', 
        desc: 'Елегантни Зебра щори. Модели: Стандарт, С кутия и водачи, Макс Бокс.', 
        hero: '/images/hero-day-night.jpg' 
    },
    // 8. Хармония
    { 
        slug: 'harmony', 
        title: 'Щора Хармония', 
        desc: 'Ефирна елегантност, съчетаваща функциите на перде и щора в едно.', 
        hero: '/images/hero-harmony.jpg' 
    },
    // 9. Вертикални Ден и Нощ
    { 
        slug: 'vertical-day-night', 
        title: 'Вертикални Ден и Нощ', 
        desc: 'Иновация, съчетаваща вертикални ленти с ефекта на прозрачност и плътност.', 
        hero: '/images/hero-vertical-dn.jpg' 
    },
    // 10. Моторизирани
    { 
        slug: 'motorized', 
        title: 'Ел. Корнизи и Автоматизация', 
        desc: 'Умни решения с мотори Somfy и Motion за вашия комфорт. Управление с дистанционно или телефон.', 
        hero: '/images/hero-motorized.jpg' 
    }
  ];
  return categories.map((category) => {
    // Филтрираме само продуктите за тази категория
    const categoryProducts = products.filter(p => p.category === category.slug);
    
    return {
      params: { type: category.slug },
      props: { category, products: categoryProducts },
    };
  });
}

const { category, products: categoryProducts } = Astro.props;
---

<Layout title={`${category.title} | ЛуксБлайндс`}>
  
  <div class="relative h-[40vh] min-h-75 flex items-center justify-center">
    <div class="absolute inset-0">
        <img src={`${base}${category.hero}`} class="w-full h-full object-cover" alt={category.title} />
        <div class="absolute inset-0 bg-slate-900/60"></div>
    </div>
    <div class="relative z-10 text-center text-white p-6">
        <h1 class="text-5xl font-bold mb-4">{category.title}</h1>
        <p class="text-xl text-slate-200">{category.desc}</p>
    </div>
  </div>

  <section class="py-16 container mx-auto px-6">
    <a href={`${base}`} class="inline-flex items-center text-blue-600 font-semibold mb-8 hover:underline">← Обратно към началото</a>

    <div class="grid md:grid-cols-3 gap-8">
        {categoryProducts.length > 0 ? (
            categoryProducts.map((product) => (
                <div class="bg-white rounded-xl shadow-lg overflow-hidden hover:shadow-2xl transition border border-slate-100 group flex flex-col h-full">
                    <div class="h-64 overflow-hidden relative">
                        <img 
                            src={`${base}${product.images[0]}`} 
                            alt={product.name} 
                            class="w-full h-full object-cover transition duration-500 group-hover:scale-110"
                        />
                        <div class="absolute top-4 right-4 bg-white/90 px-3 py-1 rounded-full text-xs font-bold shadow-sm">
                            {product.price}
                        </div>
                    </div>
                    <div class="p-6 flex flex-col grow">
                        <h3 class="text-xl font-bold text-slate-800 mb-2">{product.name}</h3>
                        <p class="text-slate-500 text-sm mb-6 grow">{product.shortDesc}</p>
                        
                        <a href={`${base}/product/${product.id}`} class="w-full block text-center bg-slate-900 text-white py-3 rounded-lg hover:bg-blue-600 transition">
                            Виж повече снимки
                        </a>
                    </div>
                </div>
            ))
        ) : (
            <p class="text-slate-500 text-lg col-span-3 text-center">Все още няма добавени продукти в тази категория.</p>
        )}
    </div>
  </section>

</Layout>