---
import Layout from '../../layouts/Layout.astro';
import { products } from '../../data/products'; // Импортираме продуктите

export async function getStaticPaths() {
  // Дефинираме категориите
  const categories = [
    { 
        slug: 'roman', 
        title: 'Римски щори', 
        desc: 'Класика и уют.', 
        hero: 'https://images.unsplash.com/photo-1505691938895-1758d7bab58d?w=1200' 
    },
    { 
        slug: 'wooden', 
        title: 'Дървени щори', 
        desc: 'Естествени материали.', 
        hero: 'https://images.unsplash.com/photo-1615529182904-14819c35db37?w=1200' 
    },
       { 
        slug: 'smart', 
        title: 'Смарт щори', 
        desc: 'Интелигентни решения за мързеливи домакини.', 
        hero: 'https://images.unsplash.com/photo-1615529182904-14819c35db37?w=1200' 
    },
       { 
        slug: 'exterior', 
        title: 'Външни щори', 
        desc: 'Стилен избор за външни пространства.', 
        hero: 'https://images.unsplash.com/photo-1615529182904-14819c35db37?w=1200' 
    },
       { 
        slug: 'plise', 
        title: 'Плисе щори', 
        desc: 'Естествени материали.', 
        hero: 'https://images.unsplash.com/photo-1615529182904-14819c35db37?w=1200' 
    },
    // Добави другите категории тук...
  ];

  return categories.map((category) => {
    // Филтрираме само продуктите за тази категория
    const categoryProducts = products.filter(p => p.category === category.slug);
    
    return {
      params: { type: category.slug },
      props: { category, products: categoryProducts },
    };
  });
}

const { category, products: categoryProducts } = Astro.props;
---

<Layout title={`${category.title} | ЛуксБлайндс`}>
  
  <div class="relative h-[40vh] min-h-75 flex items-center justify-center">
    <div class="absolute inset-0">
        <img src={category.hero} class="w-full h-full object-cover" alt={category.title} />
        <div class="absolute inset-0 bg-slate-900/60"></div>
    </div>
    <div class="relative z-10 text-center text-white p-6">
        <h1 class="text-5xl font-bold mb-4">{category.title}</h1>
        <p class="text-xl text-slate-200">{category.desc}</p>
    </div>
  </div>

  <section class="py-16 container mx-auto px-6">
    <a href="/" class="inline-flex items-center text-blue-600 font-semibold mb-8 hover:underline">← Обратно към началото</a>

    <div class="grid md:grid-cols-3 gap-8">
        {categoryProducts.length > 0 ? (
            categoryProducts.map((product) => (
                <div class="bg-white rounded-xl shadow-lg overflow-hidden hover:shadow-2xl transition border border-slate-100 group flex flex-col h-full">
                    <div class="h-64 overflow-hidden relative">
                        <img 
                            src={product.images[0]} 
                            alt={product.name} 
                            class="w-full h-full object-cover transition duration-500 group-hover:scale-110"
                        />
                        <div class="absolute top-4 right-4 bg-white/90 px-3 py-1 rounded-full text-xs font-bold shadow-sm">
                            {product.price}
                        </div>
                    </div>
                    <div class="p-6 flex flex-col grow">
                        <h3 class="text-xl font-bold text-slate-800 mb-2">{product.name}</h3>
                        <p class="text-slate-500 text-sm mb-6 grow">{product.shortDesc}</p>
                        
                        <a href={`/product/${product.id}`} class="w-full block text-center bg-slate-900 text-white py-3 rounded-lg hover:bg-blue-600 transition">
                            Виж повече снимки
                        </a>
                    </div>
                </div>
            ))
        ) : (
            <p class="text-slate-500 text-lg col-span-3 text-center">Все още няма добавени продукти в тази категория.</p>
        )}
    </div>
  </section>

</Layout>